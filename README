Commit functioning code that has been finialized to master only
